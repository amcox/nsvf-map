slopegraph(cancer, col.line='gray', xlim=c(-.5,5.5),#
           labels=c('5 Year','10 Year','15 Year','20 Year'), binval=4.5)
slopegraph(cancer, col.line='gray', xlim=c(-.5,5.5),#
           labels=c('5 Year','10 Year','15 Year','20 Year'), binval=.5)
slopegraph(cancer, col.line='gray', xlim=c(-.5,5.5),#
           labels=c('5 Year','10 Year','15 Year','20 Year'), binval=0.5)
slopegraph(cancer, col.line='gray', xlim=c(-.5,5.5),#
           labels=c('5 Year','10 Year','15 Year','20 Year'), binval=1.5)
slopegraph(d1, decimals=1, binval=4)
table.graph(WorldPhones[,1:2], label.cex=0.7, title.cex=1.2, mar=c(5, 5, 1, 5))
setwd('/Users/Andrew/Downloads/r-slopegraph-master')
##' R script for creating slopegraphs#
##' James Keirstead#
##' 16 July 2011#
##' http://www.jameskeirstead.ca/r/slopegraphs-in-r/ #
#
##' Load in the health care data and required functions#
data <- read.csv("cancer_survival_rates.csv")#
source("slopegraph.r")#
#
##' Convert raw data to right format#
df <- build_slopegraph(data, x="year", y="value", group="group", method="tufte", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y))#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
#
##' Save the results#
w <- 6  	# width in inches#
h <- 1.6*w	# height in inches#
ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
dpi <- 150  	# resolution for png#
ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
gg.form
str(dt)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds <- subset(dt, subject == 'reading' & grade == 0)#
ds <- ds[, c("school", "period", "perc.above.median")]
str(ds)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
update_functions()
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dk <- build_slopegraph(ds, x="period", y="perc.above.median", group="school", method="tufte", min.space=0.05)
dk
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
plot_slopegraph(dk)
?round
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dk$y <- round(dk$y, digits=2)#
plot_slopegraph(dk)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds <- subset(dt, subject == 'reading' & grade == 0 & !is.na(perc.above.median))#
ds <- ds[, c("school", "period", "perc.above.median")]#
#
dk <- build_slopegraph(ds, x="period", y="perc.above.median", group="school", method="tufte", min.space=0.05)#
dk$y <- round(dk$y, digits=2)#
plot_slopegraph(dk)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds <- subset(dt, subject == 'reading' & grade == 0)#
ds <- ds[, c("school", "period", "perc.above.median")]#
ds$perc.above.median <- ds$perc.above.median * 100#
dw <- dcast(ds, school ~ period)#
#
d1 <- dw[,2:3]#
row.names(d1) <- dw$school#
d1 <- d1[complete.cases(d1),]#
#
slopegraph(d1)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds <- subset(dt, subject == 'reading' & grade == 0 & !is.na(perc.above.median))#
ds <- ds[, c("school", "period", "perc.above.median")]#
#
dk <- build_slopegraph(ds, x="period", y="perc.above.median", group="school", method="tufte", min.space=0.05)#
dk$y <- round(dk$y, digits=2)#
plot_slopegraph(dk)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dk <- build_slopegraph(ds, x="period", y="perc.above.median", group="school", method="rank", min.space=0.05)#
dk$y <- round(dk$y, digits=2)#
plot_slopegraph(dk)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dk <- build_slopegraph(ds, x="period", y="perc.above.median", group="school", method="spaced", min.space=0.05)#
dk$y <- round(dk$y, digits=2)#
plot_slopegraph(dk)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dk <- build_slopegraph(ds, x="period", y="perc.above.median", group="school", method="none", min.space=0.05)#
dk$y <- round(dk$y, digits=2)#
plot_slopegraph(dk)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
##' R script for creating slopegraphs#
##' James Keirstead#
##' 16 July 2011#
##' http://www.jameskeirstead.ca/r/slopegraphs-in-r/ #
#
##' Load in the health care data and required functions#
data <- read.csv("cancer_survival_rates.csv")#
source("slopegraph.r")#
#
##' Convert raw data to right format#
df <- build_slopegraph(data, x="year", y="value", group="group", method="tufte", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y))#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
#
##' Save the results#
w <- 6  	# width in inches#
h <- 1.6*w	# height in inches#
ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
dpi <- 150  	# resolution for png#
ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
##' R script for creating slopegraphs#
##' James Keirstead#
##' 16 July 2011#
##' http://www.jameskeirstead.ca/r/slopegraphs-in-r/ #
#
##' Load in the health care data and required functions#
data <- read.csv("cancer_survival_rates.csv")#
source("slopegraph.r")#
#
##' Convert raw data to right format#
df <- build_slopegraph(data, x="year", y="value", group="group", method="tufte", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y))#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
#
##' Save the results#
w <- 6  	# width in inches#
h <- 1.6*w	# height in inches#
ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
dpi <- 150  	# resolution for png#
ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
ggfrom
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
theme_slopegraph <- function (base_size = 12, base_family = "") {#
    require(grid)#
    theme(axis.line = element_blank(),#
          axis.text = element_text(colour="black"),#
          axis.text.x = element_text(size = rel(1), lineheight = 0.9,#
              vjust = 1),#
          axis.text.y = element_blank(), # axis.text.y = element_text(size=rel(0.8)),#
          axis.ticks = element_blank(),#
          axis.title.x = element_blank(),#
          axis.title.y = element_blank(),#
          axis.ticks.length = unit(0, "lines"),#
          axis.ticks.margin = unit(0, "lines"), #
          panel.background = element_blank(),#
          panel.border = element_blank(),#
          panel.grid.major = element_blank(),#
          panel.grid.minor = element_blank(),#
          panel.margin = unit(0.25, "lines"), #
          strip.background = element_blank(),#
          strip.text.x = element_text(size = rel(0.8)),#
          strip.text.y = element_blank(),#
          plot.background = element_blank(),#
          plot.title = element_text(size = rel(1)),#
          plot.margin = unit(c(1, 0.5, 0.5, 0.5), "lines"),#
          complete=FALSE)#
}#
##' Plots a slopegraph#
##'#
##' @param df a data frame giving the data#
##' @return a ggplot object#
##' @import ggplot2#
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        # scale_y_continuous(name="", breaks=yvals, labels=ylabs)#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf(” %s”, group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf(“%s “, group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
theme_slopegraph <- function (base_size = 12, base_family = "") {#
    require(grid)#
    theme(axis.line = element_blank(),#
          axis.text = element_text(colour="black"),#
          axis.text.x = element_text(size = rel(1), lineheight = 0.9,#
              vjust = 1),#
          axis.text.y = element_blank(),#
          axis.ticks = element_blank(),#
          axis.title.x = element_blank(),#
          axis.title.y = element_blank(),#
          axis.ticks.length = unit(0, "lines"),#
          axis.ticks.margin = unit(0, "lines"), #
          panel.background = element_blank(),#
          panel.border = element_blank(),#
          panel.grid.major = element_blank(),#
          panel.grid.minor = element_blank(),#
          panel.margin = unit(0.25, "lines"), #
          strip.background = element_blank(),#
          strip.text.x = element_text(size = rel(0.8)),#
          strip.text.y = element_blank(),#
          plot.background = element_blank(),#
          plot.title = element_text(size = rel(1)),#
          plot.margin = unit(c(1, 0.5, 0.5, 0.5), "lines"),#
          complete=FALSE)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        # scale_y_continuous(name="", breaks=yvals, labels=ylabs)#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf(” %s”, group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf(“%s “, group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf(” %s”, group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf(“%s “, group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf(" %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s ", group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
##' R script for creating slopegraphs#
##' James Keirstead#
##' 16 July 2011#
##' http://www.jameskeirstead.ca/r/slopegraphs-in-r/ #
#
##' Load in the health care data and required functions#
data <- read.csv("cancer_survival_rates.csv")#
source("slopegraph.r")#
#
##' Convert raw data to right format#
df <- build_slopegraph(data, x="year", y="value", group="group", method="tufte", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y))#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
#
##' Save the results#
w <- 6  	# width in inches#
h <- 1.6*w	# height in inches#
ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
dpi <- 150  	# resolution for png#
ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
##' R script for creating slopegraphs#
##' James Keirstead#
##' 16 July 2011#
##' http://www.jameskeirstead.ca/r/slopegraphs-in-r/ #
#
##' Load in the health care data and required functions#
data <- read.csv("cancer_survival_rates.csv")#
source("slopegraph.r")#
#
##' Convert raw data to right format#
df <- build_slopegraph(data, x="year", y="value", group="group", method="tufte", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y))#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
gg.form <- plot_slopegraph(df, method="spaced") +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y), method="spaced"#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
theme_slopegraph <- function (base_size = 12, base_family = "") {#
    require(grid)#
    theme(axis.line = element_blank(),#
          axis.text = element_text(colour="black"),#
          axis.text.x = element_text(size = rel(1), lineheight = 0.9,#
              vjust = 1),#
          axis.text.y = element_text(size=rel(0.8)),#
          axis.ticks = element_blank(),#
          axis.title.x = element_blank(),#
          axis.title.y = element_blank(),#
          axis.ticks.length = unit(0, "lines"),#
          axis.ticks.margin = unit(0, "lines"), #
          panel.background = element_blank(),#
          panel.border = element_blank(),#
          panel.grid.major = element_blank(),#
          panel.grid.minor = element_blank(),#
          panel.margin = unit(0.25, "lines"), #
          strip.background = element_blank(),#
          strip.text.x = element_text(size = rel(0.8)),#
          strip.text.y = element_blank(),#
          plot.background = element_blank(),#
          plot.title = element_text(size = rel(1)),#
          plot.margin = unit(c(1, 0.5, 0.5, 0.5), "lines"),#
          complete=FALSE)#
}#
##' Plots a slopegraph#
##'#
##' @param df a data frame giving the data#
##' @return a ggplot object#
##' @import ggplot2#
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        scale_y_continuous(name="", breaks=yvals, labels=ylabs)#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
theme_slopegraph <- function (base_size = 12, base_family = "") {#
    require(grid)#
    theme(axis.line = element_blank(),#
          axis.text = element_text(colour="black"),#
          axis.text.x = element_text(size = rel(1), lineheight = 0.9,#
              vjust = 1),#
          axis.text.y = element_blank(),#
          axis.ticks = element_blank(),#
          axis.title.x = element_blank(),#
          axis.title.y = element_blank(),#
          axis.ticks.length = unit(0, "lines"),#
          axis.ticks.margin = unit(0, "lines"), #
          panel.background = element_blank(),#
          panel.border = element_blank(),#
          panel.grid.major = element_blank(),#
          panel.grid.minor = element_blank(),#
          panel.margin = unit(0.25, "lines"), #
          strip.background = element_blank(),#
          strip.text.x = element_text(size = rel(0.8)),#
          strip.text.y = element_blank(),#
          plot.background = element_blank(),#
          plot.title = element_text(size = rel(1)),#
          plot.margin = unit(c(1, 0.5, 0.5, 0.5), "lines"),#
          complete=FALSE)#
}#
##' Plots a slopegraph#
##'#
##' @param df a data frame giving the data#
##' @return a ggplot object#
##' @import ggplot2#
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf(" %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s ", group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
?geom_text
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf(" %s", group)),#
          size = rel(2.8), hjust = 5#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s ", group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
str(df)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf(" %s", group)),#
          size = rel(2.8), hjust = 2#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s ", group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
theme_slopegraph <- function (base_size = 12, base_family = "") {#
    require(grid)#
    theme(axis.line = element_blank(),#
          axis.text = element_text(colour="black"),#
          axis.text.x = element_text(size = rel(1), lineheight = 0.9,#
              vjust = 1),#
          axis.text.y = element_blank(),#
          axis.ticks = element_blank(),#
          axis.title.x = element_blank(),#
          axis.title.y = element_blank(),#
          axis.ticks.length = unit(0, "lines"),#
          axis.ticks.margin = unit(0, "lines"), #
          panel.background = element_blank(),#
          panel.border = element_blank(),#
          panel.grid.major = element_blank(),#
          panel.grid.minor = element_blank(),#
          panel.margin = unit(3.25, "lines"), #
          strip.background = element_blank(),#
          strip.text.x = element_text(size = rel(0.8)),#
          strip.text.y = element_blank(),#
          plot.background = element_blank(),#
          plot.title = element_text(size = rel(1)),#
          plot.margin = unit(c(1, 0.5, 0.5, 0.5), "lines"),#
          complete=FALSE)#
}#
##' Plots a slopegraph#
##'#
##' @param df a data frame giving the data#
##' @return a ggplot object#
##' @import ggplot2#
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
theme_slopegraph <- function (base_size = 12, base_family = "") {#
    require(grid)#
    theme(axis.line = element_blank(),#
          axis.text = element_text(colour="black"),#
          axis.text.x = element_text(size = rel(1), lineheight = 0.9,#
              vjust = 1),#
          axis.text.y = element_blank(),#
          axis.ticks = element_blank(),#
          axis.title.x = element_blank(),#
          axis.title.y = element_blank(),#
          axis.ticks.length = unit(0, "lines"),#
          axis.ticks.margin = unit(0, "lines"), #
          panel.background = element_blank(),#
          panel.border = element_blank(),#
          panel.grid.major = element_blank(),#
          panel.grid.minor = element_blank(),#
          panel.margin = unit(0.25, "lines"), #
          strip.background = element_blank(),#
          strip.text.x = element_text(size = rel(0.8)),#
          strip.text.y = element_blank(),#
          plot.background = element_blank(),#
          plot.title = element_text(size = rel(1)),#
          plot.margin = unit(c(1, 2.5, 2.5, 0.5), "lines"),#
          complete=FALSE)#
}#
##' Plots a slopegraph#
##'#
##' @param df a data frame giving the data#
##' @return a ggplot object#
##' @import ggplot2#
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
theme_slopegraph <- function (base_size = 12, base_family = "") {#
    require(grid)#
    theme(axis.line = element_blank(),#
          axis.text = element_text(colour="black"),#
          axis.text.x = element_text(size = rel(1), lineheight = 0.9,#
              vjust = 1),#
          axis.text.y = element_blank(),#
          axis.ticks = element_blank(),#
          axis.title.x = element_blank(),#
          axis.title.y = element_blank(),#
          axis.ticks.length = unit(0, "lines"),#
          axis.ticks.margin = unit(0, "lines"), #
          panel.background = element_blank(),#
          panel.border = element_blank(),#
          panel.grid.major = element_blank(),#
          panel.grid.minor = element_blank(),#
          panel.margin = unit(0.25, "lines"), #
          strip.background = element_blank(),#
          strip.text.x = element_text(size = rel(0.8)),#
          strip.text.y = element_blank(),#
          plot.background = element_blank(),#
          plot.title = element_text(size = rel(1)),#
          plot.margin = unit(c(5, 5.5, 5.5, 5.5), "lines"),#
          complete=FALSE)#
}#
##' Plots a slopegraph#
##'#
##' @param df a data frame giving the data#
##' @return a ggplot object#
##' @import ggplot2#
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
theme_slopegraph <- function (base_size = 12, base_family = "") {#
    require(grid)#
    theme(axis.line = element_blank(),#
          axis.text = element_text(colour="black"),#
          axis.text.x = element_text(size = rel(1), lineheight = 0.9,#
              vjust = 1),#
          axis.text.y = element_blank(),#
          axis.ticks = element_blank(),#
          axis.title.x = element_blank(),#
          axis.title.y = element_blank(),#
          axis.ticks.length = unit(0, "lines"),#
          axis.ticks.margin = unit(0, "lines"), #
          panel.background = element_blank(),#
          panel.border = element_blank(),#
          panel.grid.major = element_blank(),#
          panel.grid.minor = element_blank(),#
          panel.margin = unit(10.25, "lines"), #
          strip.background = element_blank(),#
          strip.text.x = element_text(size = rel(0.8)),#
          strip.text.y = element_blank(),#
          plot.background = element_blank(),#
          plot.title = element_text(size = rel(1)),#
          plot.margin = unit(c(5, 5.5, 5.5, 5.5), "lines"),#
          complete=FALSE)#
}#
##' Plots a slopegraph#
##'#
##' @param df a data frame giving the data#
##' @return a ggplot object#
##' @import ggplot2#
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
theme_slopegraph <- function (base_size = 12, base_family = "") {#
    require(grid)#
    theme(axis.line = element_blank(),#
          axis.text = element_text(colour="black"),#
          axis.text.x = element_text(size = rel(1), lineheight = 0.9,#
              vjust = 1),#
          axis.text.y = element_blank(),#
          axis.ticks = element_blank(),#
          axis.title.x = element_blank(),#
          axis.title.y = element_blank(),#
          axis.ticks.length = unit(0, "lines"),#
          axis.ticks.margin = unit(0, "lines"), #
          panel.background = element_blank(),#
          panel.border = element_blank(),#
          panel.grid.major = element_blank(),#
          panel.grid.minor = element_blank(),#
          panel.margin = unit(0.25, "lines"), #
          strip.background = element_blank(),#
          strip.text.x = element_text(size = rel(0.8)),#
          strip.text.y = element_blank(),#
          plot.background = element_blank(),#
          plot.title = element_text(size = rel(1)),#
          plot.margin = unit(c(0, 0, 0, 0), "lines"),#
          complete=FALSE)#
}#
##' Plots a slopegraph#
##'#
##' @param df a data frame giving the data#
##' @return a ggplot object#
##' @import ggplot2#
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
?expand
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=c(1, 1))#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=c(1, 2))#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=c(1, 1))#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
?scale_x_discrete
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=c(1, 0))#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=c(0, 0))#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
waiver()
expand()
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=c(.75, 0))#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=c(NA, 0))#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=c(0, 1))#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=c(0, 2))#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=c(0, 1.5))#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
plot_slopegraph <- function(df, expand.factor=waiver()) {#
    ylabs <- subset(df, x==head(x,1))$group#
    yvals <- subset(df, x==head(x,1))$ypos#
    fontSize <- 2.5#
    gg <- ggplot(df,aes(x=x,y=ypos)) +#
        geom_line(aes(group=group),colour="grey80") +#
        geom_point(colour="white",size=8) +#
        geom_text(aes(label=y),size=fontSize) +#
        geom_text(data=subset(df, x == df$x[length(df$x)]),#
          aes(x = factor(x), label = sprintf("   %s", group)),#
          size = rel(2.8), hjust = 0#
        ) +#
        geom_text(data = subset(df, x == df$x[1]),#
          aes(x = factor(x), label = sprintf("%s   ", group)),#
          size = rel(2.8), hjust = 1#
        )+#
        scale_x_discrete(expand=expand.factor)#
    gg.form <- gg + theme_slopegraph()#
    return(gg.form)#
}
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df) +#
    labs(title="Estimates of % survival rates") #
gg.form#
#
# ##' Save the results#
# w <- 6    # width in inches#
# h <- 1.6*w  # height in inches#
# ggsave("slopegraph.pdf",gg.form,w=w,h=h)#
# dpi <- 150    # resolution for png#
# ggsave("slopegraph.png",gg.form,w=w,h=h,dpi=dpi)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
gg.form <- plot_slopegraph(df, expand.factor=c(0, .75)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="tufte", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="none", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dk <- build_slopegraph(ds, x="period", y="perc.above.median", group="school", method="spaced", min.space=0.05)#
dk$y <- round(dk$y, digits=2)#
plot_slopegraph(dk)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="tufte", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="none", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="tufte", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dk <- build_slopegraph(ds, x="period", y="perc.above.median", group="school", method="spaced", min.space=0.05)#
dk$y <- round(dk$y, digits=2)#
plot_slopegraph(dk)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="none", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="tufte", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dk <- build_slopegraph(ds, x="period", y="perc.above.median", group="school", method="tufte", min.space=0.05)#
dk$y <- round(dk$y, digits=2)#
plot_slopegraph(dk)
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="tufte", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="none", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
setwd('/Users/Andrew/Documents/Programming/R Scripts/r-slopegraph')
df <- build_slopegraph(data, x="year", y="value", group="group", method="spaced", min.space=0.05)#
#
## Refactor the x-axis to get the right labels, round the y values for presentation#
df <- transform(df, x=factor(x, levels=c(5,10,15,20),#
                        labels=c("5 years", "10 years", "15 years", "20 years")),#
                y=round(y)#
      )#
##' Generate the raw plot#
gg.form <- plot_slopegraph(df, expand.factor=c(0, 2)) +#
    labs(title="Estimates of % survival rates") #
gg.form
str(ds)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dc <- dcast(ds, school ~ period)
dc
?dcast
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dc <- ds#
dc$perc.above.median <- round(dc$perc.above.median, 2)#
dc <- dcast(ds, school ~ period)
dc
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dc <- ds
str(dc)
dc
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dc$perc.above.median <- round(dc$perc.above.median, 2)
dc
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dc <- dcast(dc, school ~ period)
dc
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
save_as_csv(dc, "test map percs")
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
update_functions()
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
save_as_csv(dc, "test map percs")
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
save_df_as_csv(dc, "test map percs")
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dc$perc.above.median <- round(dc$perc.above.median, 2) * 100#
dc <- dcast(dc, school ~ period)#
save_df_as_csv(dc, "test map percs")
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dc <- ds#
dc$perc.above.median <- round(dc$perc.above.median, 2) * 100#
dc <- dcast(dc, school ~ period)#
save_df_as_csv(dc, "test map percs")
dc
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds <- dt[, c("school", "period", "perc.above.median")]
str(dt)
str(ds)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds$perc.above.median <- round(ds$perc.above.median, 2) * 100
str(ds)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds <- subset(dt, subject == 'reading' & grade == 0 & !is.na(perc.above.median))
str(ds)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds <- subset(ds, !is.na(perc.above.median))
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds$perc.above.median <- round(ds$perc.above.median, 2) * 100
str(ds)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds <- dt[, c("school", "period", "perc.above.median")]#
ds <- subset(ds, !is.na(perc.above.median))#
ds$perc.above.median <- round(ds$perc.above.median, 2) * 100
str(ds)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
ds <- dt[, c("subject", "grade", "school", "period", "perc.above.median")]#
ds <- subset(ds, !is.na(perc.above.median))#
ds$perc.above.median <- round(ds$perc.above.median, 2) * 100
str(ds)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dc <- dcast(dc, subject + grade + school ~ period)
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
dc <- dcast(ds, subject + grade + school ~ period)
dc
setwd('/Users/Andrew/Dropbox/ReNew/Data Analysis/NSVF Shared Data/R')
save_df_as_csv(dc, "all map percs")
